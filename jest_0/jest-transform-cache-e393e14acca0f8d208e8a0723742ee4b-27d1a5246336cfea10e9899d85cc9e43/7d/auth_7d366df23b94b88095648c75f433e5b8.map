{"version":3,"sources":["auth.js"],"names":["authStart","type","actionTypes","AUTH_START","authSuccess","token","userId","AUTH_SUCCESS","idToken","authFail","error","AUTH_FAIL","logout","localStorage","removeItem","AUTH_LOGOUT","checkAuthTimeOut","expirationTime","dispatch","setTimeout","auth","email","password","isSignUp","authData","returnSecureToken","url","axios","post","then","response","expirationDate","Date","getTime","data","expiresIn","setItem","localId","catch","err","console","log","setAuthRedirectPath","path","SET_AUTH_REDIRECT_PATH","authCheckState","getItem"],"mappings":"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","sourcesContent":["import * as actionTypes from './actionTypes'\n\nimport axios from 'axios'\n\nexport const authStart = () => {\n    return{\n        type: actionTypes.AUTH_START\n    }\n}\n\nexport const authSuccess = (token, userId) => {\n    return{\n        type: actionTypes.AUTH_SUCCESS,\n        idToken: token,\n        userId: userId\n    }\n}\n\nexport const authFail = (error) => {\n    return{\n        type: actionTypes.AUTH_FAIL,\n        error: error\n    }\n}\n\nexport const logout = () => {\n    localStorage.removeItem('token')\n    localStorage.removeItem('expirationDate')\n    localStorage.removeItem('localId')\n    return{\n        type: actionTypes.AUTH_LOGOUT,\n\n    }\n}\n\nexport const checkAuthTimeOut = (expirationTime) => {\n    return dispatch => {\n        setTimeout(()=>{\n            dispatch(logout())\n        },expirationTime * 1000)\n    }\n}\n\nexport const auth = (email, password, isSignUp) => {\n    return dispatch =>{\n        dispatch(authStart());\n        const authData = {\n            email: email,\n            password: password,\n            returnSecureToken: true\n        }\n        let url = 'https://www.googleapis.com/identitytoolkit/v3/relyingparty/signupNewUser?key=AIzaSyDEEx2G2BLB7YwRVPqMEVUHCKsQj3ZRRL0'\n        if(!isSignUp){\n            url = 'https://www.googleapis.com/identitytoolkit/v3/relyingparty/verifyPassword?key=AIzaSyDEEx2G2BLB7YwRVPqMEVUHCKsQj3ZRRL0'\n        }\n        axios.post(url, authData)\n        .then(response=>{\n            const expirationDate = new Date(new Date().getTime() + response.data.expiresIn * 1000)\n            localStorage.setItem('token',response.data.idToken)\n            localStorage.setItem('expirationDate',expirationDate)\n            localStorage.setItem('userId',response.data.localId)\n            dispatch(authSuccess(response.data.idToken, response.data.localId))\n            dispatch(checkAuthTimeOut(response.data.expiresIn))\n        })\n        .catch(err => {\n            console.log(err)\n            dispatch(authFail(err.response.data.error))\n        })\n    }\n}\n\nexport const setAuthRedirectPath = (path) => {\n    return{\n        type: actionTypes.SET_AUTH_REDIRECT_PATH,\n        path: path\n    }\n}\n\nexport const authCheckState = () => {\n    return dispatch => {\n        const token = localStorage.getItem('token')\n        if(!token){\n            dispatch(logout)\n        } else {\n            const expirationDate = new Date(localStorage.getItem('expirationDate'))\n            if(expirationDate<=new Date()){\n                dispatch(logout())\n            }else{\n                const userId = localStorage.getItem('userId')\n                dispatch(authSuccess(token, userId))\n                dispatch(checkAuthTimeOut(expirationDate.getTime() - new Date().getTime()))\n            }\n            \n        }\n    }\n}\n\n\n\n"]}